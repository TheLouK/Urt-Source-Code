Index: code/server/sv_client.c
===================================================================
--- code/server/sv_client.c	(revision 738)
+++ code/server/sv_client.c	(working copy)
@@ -441,6 +441,13 @@
 				Com_DPrintf ("Client %i rejected on a too high ping\n", i);
 				return;
 			}
+
+			// I guess we're not checking for the qport 1337 hack on LAN clients.
+			if (sv_block1337->integer > 0 && qport == 1337) {
+				NET_OutOfBandPrint(NS_SERVER, from, "print\nThis server is not for wussies.\n");
+				Com_DPrintf("1337 qport, rejected connect from %s\n", NET_AdrToString(from));
+				return;
+			}
 		}
 	}
 
Index: code/server/server.h
===================================================================
--- code/server/server.h	(revision 738)
+++ code/server/server.h	(working copy)
@@ -300,6 +300,8 @@
 
 extern	cvar_t	*sv_userinfoFloodProtect;
 
+extern	cvar_t	*sv_block1337;
+
 extern	serverBan_t serverBans[SERVER_MAXBANS];
 extern	int serverBansCount;
 
@@ -307,7 +309,6 @@
 extern	cvar_t	*sv_voip;
 #endif
 
-
 //===========================================================
 
 //
Index: code/server/sv_init.c
===================================================================
--- code/server/sv_init.c	(revision 738)
+++ code/server/sv_init.c	(working copy)
@@ -688,6 +688,8 @@
 
 	sv_userinfoFloodProtect = Cvar_Get ("sv_userinfoFloodProtect", "1", CVAR_ARCHIVE | CVAR_SERVERINFO );
 
+	sv_block1337 = Cvar_Get ("sv_block1337", "0", CVAR_ARCHIVE );
+
 	// initialize bot cvars so they are listed and can be set before loading the botlib
 	SV_BotInitCvars();
 
Index: code/server/sv_main.c
===================================================================
--- code/server/sv_main.c	(revision 738)
+++ code/server/sv_main.c	(working copy)
@@ -61,6 +61,9 @@
 cvar_t	*sv_userinfoFloodProtect;	// whether to limit two client userinfo changes per 2000 milliseconds,
 					// default 1 (limit)
 
+cvar_t	*sv_block1337;			// whether to block clients with qport 1337,
+					// default 0 don't block
+
 serverBan_t serverBans[SERVER_MAXBANS];
 int serverBansCount = 0;
 
